  sheet.getRangeByName('A${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('B${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('C${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('D${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('E${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('F${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('G${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('H${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('I${index + 1}').cellStyle = globalStyle220;

      sheet.getRangeByName('J${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('K${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('L${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('M${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('N${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('O${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('P${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('Q${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('R${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('S${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('T${index + 1}').cellStyle = globalStyle220;

      sheet.getRangeByName('U${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('V${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('W${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('X${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('Y${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('Z${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AA${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AB${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AC${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AD${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AE${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AF${index + 1}').cellStyle = globalStyle220;

      sheet.getRangeByName('AG${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AH${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AI${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AJ${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AK${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AL${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AM${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AN${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AO${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AP${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AQ${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AR${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AS${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AT${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AU${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AV${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AW${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AX${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AY${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('AZ${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('BA${index + 1}').cellStyle = globalStyle220;
      sheet.getRangeByName('BB${index + 1}').cellStyle = globalStyle220;

      ////
    }

    globalStyle2.hAlign = x.HAlignType.center;
    sheet.getRangeByName('A6').cellStyle = globalStyle1;
    sheet.getRangeByName('B6').cellStyle = globalStyle1;
    sheet.getRangeByName('C6').cellStyle = globalStyle1;
    sheet.getRangeByName('D6').cellStyle = globalStyle1;
    sheet.getRangeByName('E6').cellStyle = globalStyle1;
    sheet.getRangeByName('F6').cellStyle = globalStyle1;
    sheet.getRangeByName('G6').cellStyle = globalStyle1;
    sheet.getRangeByName('H6').cellStyle = globalStyle1;
    sheet.getRangeByName('I6').cellStyle = globalStyle1;
    sheet.getRangeByName('J6').cellStyle = globalStyle1;
    sheet.getRangeByName('K6').cellStyle = globalStyle1;
    sheet.getRangeByName('L6').cellStyle = globalStyle1;
    sheet.getRangeByName('M6').cellStyle = globalStyle1;
    sheet.getRangeByName('N6').cellStyle = globalStyle1;
    sheet.getRangeByName('O6').cellStyle = globalStyle1;
    sheet.getRangeByName('P6').cellStyle = globalStyle1;
    sheet.getRangeByName('Q6').cellStyle = globalStyle1;
    sheet.getRangeByName('R6').cellStyle = globalStyle1;
    sheet.getRangeByName('S6').cellStyle = globalStyle1;
    sheet.getRangeByName('T6').cellStyle = globalStyle1;
    sheet.getRangeByName('U6').cellStyle = globalStyle1;
    sheet.getRangeByName('V6').cellStyle = globalStyle1;
    sheet.getRangeByName('W6').cellStyle = globalStyle1;
    sheet.getRangeByName('X6').cellStyle = globalStyle1;
    sheet.getRangeByName('Y6').cellStyle = globalStyle1;
    sheet.getRangeByName('Z6').cellStyle = globalStyle1;
    sheet.getRangeByName('AA6').cellStyle = globalStyle1;
    sheet.getRangeByName('AB6').cellStyle = globalStyle1;
    sheet.getRangeByName('AC6').cellStyle = globalStyle1;
    sheet.getRangeByName('AD6').cellStyle = globalStyle1;
    sheet.getRangeByName('AE6').cellStyle = globalStyle1;
    sheet.getRangeByName('AF6').cellStyle = globalStyle1;
    sheet.getRangeByName('AG6').cellStyle = globalStyle1;
    sheet.getRangeByName('AH6').cellStyle = globalStyle1;
    sheet.getRangeByName('AI6').cellStyle = globalStyle1;
    sheet.getRangeByName('AJ6').cellStyle = globalStyle1;
    sheet.getRangeByName('AK6').cellStyle = globalStyle1;
    sheet.getRangeByName('AL6').cellStyle = globalStyle1;
    sheet.getRangeByName('AM6').cellStyle = globalStyle1;
    sheet.getRangeByName('AN6').cellStyle = globalStyle1;
    sheet.getRangeByName('AO6').cellStyle = globalStyle1;
    sheet.getRangeByName('AP6').cellStyle = globalStyle1;
    sheet.getRangeByName('AQ6').cellStyle = globalStyle1;
    sheet.getRangeByName('AR6').cellStyle = globalStyle1;
    sheet.getRangeByName('AS6').cellStyle = globalStyle1;
    sheet.getRangeByName('AT6').cellStyle = globalStyle1;
    sheet.getRangeByName('AU6').cellStyle = globalStyle1;
    sheet.getRangeByName('AV6').cellStyle = globalStyle1;
    sheet.getRangeByName('AW6').cellStyle = globalStyle1;
    sheet.getRangeByName('AX6').cellStyle = globalStyle1;
    sheet.getRangeByName('AY6').cellStyle = globalStyle1;
    sheet.getRangeByName('AZ6').cellStyle = globalStyle1;
    sheet.getRangeByName('BA6').cellStyle = globalStyle1;
    sheet.getRangeByName('BB6').cellStyle = globalStyle1;

    sheet.getRangeByName('A6').columnWidth = 10;
    sheet.getRangeByName('B6').columnWidth = 20;
    sheet.getRangeByName('C6').columnWidth = 20;
    sheet.getRangeByName('D6').columnWidth = 25;
    sheet.getRangeByName('E6').columnWidth = 25;
    sheet.getRangeByName('F6').columnWidth = 25;
    sheet.getRangeByName('G6').columnWidth = 35;
    sheet.getRangeByName('H6').columnWidth = 25;
    sheet.getRangeByName('I6').columnWidth = 25;
    sheet.getRangeByName('J6').columnWidth = 25;
    sheet.getRangeByName('K6').columnWidth = 25;
    sheet.getRangeByName('L6').columnWidth = 25;
    sheet.getRangeByName('M6').columnWidth = 25;
    sheet.getRangeByName('N6').columnWidth = 25;
    sheet.getRangeByName('O6').columnWidth = 25;
    sheet.getRangeByName('P6').columnWidth = 20;
    sheet.getRangeByName('Q6').columnWidth = 30;
    sheet.getRangeByName('R6').columnWidth = 20;
    sheet.getRangeByName('S6').columnWidth = 20;
    sheet.getRangeByName('T6').columnWidth = 20;
    sheet.getRangeByName('U6').columnWidth = 20;
    sheet.getRangeByName('V6').columnWidth = 20;
    sheet.getRangeByName('W6').columnWidth = 20;
    sheet.getRangeByName('X6').columnWidth = 20;
    sheet.getRangeByName('Y6').columnWidth = 20;
    sheet.getRangeByName('Z6').columnWidth = 20;
    sheet.getRangeByName('AA6').columnWidth = 20;
    sheet.getRangeByName('AB6').columnWidth = 20;
    sheet.getRangeByName('AC6').columnWidth = 20;
    sheet.getRangeByName('AD6').columnWidth = 20;
    sheet.getRangeByName('AE6').columnWidth = 20;
    sheet.getRangeByName('AF6').columnWidth = 20;
    sheet.getRangeByName('AG6').columnWidth = 20;
    sheet.getRangeByName('AH6').columnWidth = 20;
    sheet.getRangeByName('AI6').columnWidth = 20;
    sheet.getRangeByName('AJ6').columnWidth = 20;
    sheet.getRangeByName('AK6').columnWidth = 20;
    sheet.getRangeByName('AL6').columnWidth = 20;
    sheet.getRangeByName('AM6').columnWidth = 20;
    sheet.getRangeByName('AN6').columnWidth = 20;
    sheet.getRangeByName('AO6').columnWidth = 20;
    sheet.getRangeByName('AP6').columnWidth = 20;
    sheet.getRangeByName('AQ6').columnWidth = 20;
    sheet.getRangeByName('AR6').columnWidth = 20;
    sheet.getRangeByName('AS6').columnWidth = 20;
    sheet.getRangeByName('AT6').columnWidth = 20;
    sheet.getRangeByName('AU6').columnWidth = 20;
    sheet.getRangeByName('AV6').columnWidth = 20;
    sheet.getRangeByName('AW6').columnWidth = 20;
    sheet.getRangeByName('AX6').columnWidth = 20;
    sheet.getRangeByName('AY6').columnWidth = 20;
    sheet.getRangeByName('AZ6').columnWidth = 20;
    sheet.getRangeByName('BA6').columnWidth = 20;
    sheet.getRangeByName('BB6').columnWidth = 20;

    sheet.getRangeByName('A6').setText('ลำดับที่');
    sheet.getRangeByName('B6').setText('เลขที่สัญญา');
    sheet.getRangeByName('C6').setText('เลขที่สัญญา-เดิม');
    // sheet.getRangeByName('D6').setText('van (ตัดออกทุกรายงาน)');
    sheet.getRangeByName('D6').setText('รหัสสาขา');
    sheet.getRangeByName('E6').setText('ชื่อสาขา');
    sheet.getRangeByName('F6').setText('เลขล็อค');
    sheet.getRangeByName('G6').setText('ชื่อ-สกุล ผู้เช่า');
    sheet.getRangeByName('H6').setText('ที่อยู่');
    sheet.getRangeByName('I6').setText('เบอร์ติดต่อ');
    sheet.getRangeByName('J6').setText('วันที่เริ่มเช่า');
    sheet.getRangeByName('K6').setText('วันที่สิ้นสุดสัญญา');
    sheet.getRangeByName('L6').setText('ประเภทสินค้า');
    sheet.getRangeByName('M6').setText('น้ำ + ไฟ');
    sheet.getRangeByName('N6').setText('กำหนดยกเลิกล่วงหน้า');
    sheet.getRangeByName('O6').setText('วันที่ยกเลิกสัญญา');
    sheet.getRangeByName('P6').setText('วันที่ยกเลิกสัญญา(ในระบบ)');
    sheet.getRangeByName('Q6').setText('เงินประกัน(ก่อนVAT)');
    sheet.getRangeByName('R6').setText('เงินประกัน(VAT7%)');
    sheet.getRangeByName('S6').setText('เงินประกัน (รวมVAT)');
    sheet.getRangeByName('T6').setText('วันที่ใบเสร็จ(เงินประกัน)');
    sheet.getRangeByName('U6').setText('เลขที่ใบเสร็จ(เงินประกัน)');
    // sheet.getRangeByName('V6').setText('เงินประกัน (ตัดออก)');
    sheet.getRangeByName('V6').setText('ค่าเช่าพื้นที่(ก่อนVAT)');
    sheet.getRangeByName('W6').setText('ค่าเช่าพื้นที่(VAT7%)');
    sheet.getRangeByName('X6').setText('ค่าเช่าพื้นที่(รวมVAT)');
    sheet.getRangeByName('Y6').setText('ค่าเช่าพื้นที่(WHT)');
    sheet.getRangeByName('Z6').setText('รวมจำนวนเงินค่าเช่าพื้นที่');
    sheet.getRangeByName('AA6').setText('ค่าบริการ(ก่อนVAT)');
    sheet.getRangeByName('AB6').setText('ค่าบริการ(VAT7%)');
    sheet.getRangeByName('AC6').setText('ค่าบริการ(รวมVAT)');
    sheet.getRangeByName('AD6').setText('ค่าบริการ(WHT)');
    sheet.getRangeByName('AE6').setText('รวมจำนวนเงินค่าบริการ');
    sheet.getRangeByName('AF6').setText('ค่าเช่าพื้นที่ดิน(ก่อนVAT)');
    sheet.getRangeByName('AG6').setText('ค่าเช่าพื้นที่ดิน');

    sheet.getRangeByName('AH6').setText('ค่าเช่าพื้นที่ดิน(รวมVAT)');
    sheet.getRangeByName('AI6').setText('ค่าเช่าพื้นที่ดิน(WHT)');
    sheet.getRangeByName('AJ6').setText('รวมจำนวนเงินค่าเช่าพื้นที่ดิน');
    sheet.getRangeByName('AK6').setText('ค่าน้ำ(ก่อนVAT)');
    sheet.getRangeByName('AL6').setText('ค่าน้ำ(VAT7%)');
    sheet.getRangeByName('AM6').setText('ค่าน้ำ(รวมVAT)');
    sheet.getRangeByName('AN6').setText('ค่าไฟฟ้า(ก่อนVAT)');
    sheet.getRangeByName('AO6').setText('ค่าไฟฟ้า(VAT7%)');
    sheet.getRangeByName('AP6').setText('ค่าไฟฟ้า(รวมVAT)');
    sheet.getRangeByName('AQ6').setText('ค่าปรับ');
    sheet.getRangeByName('AR6').setText('ยอดเรียกเก็บใบวางบิล (ก่อนVAT)');
    sheet.getRangeByName('AS6').setText('ยอดเรียกเก็บใบวางบิล(VAT7%)');
    sheet.getRangeByName('AT6').setText('ยอดเรียกเก็บใบวางบิล(รวมVAT)');

    sheet.getRangeByName('AU6').setText('วันที่ชำระ');
    sheet.getRangeByName('AV6').setText('หัก');
    sheet.getRangeByName('AW6').setText('คงเหลือจ่าย');
    sheet.getRangeByName('AX6').setText('ผู้ดูแล');
    sheet.getRangeByName('AY6').setText('หมายเหตุ');
    sheet.getRangeByName('AZ6').setText('เลขที่แจ้งหนี้วางบิล');
    sheet.getRangeByName('BA6').setText('อ้างอิง');
    sheet.getRangeByName('BB6').setText('สถานะผู้เช่า');

    int index1 = 0;
    int indextotol = 0;
    List cid_number = [];

    for (int index = 0; index < teNantModels_Cancel.length; index++) {
      dynamic numberColor = ((index % 2) == 0) ? globalStyle22 : globalStyle222;
      sheet.getRangeByName('A${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('B${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('C${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('D${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('E${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('F${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('G${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('H${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('I${index + 7}').cellStyle = numberColor;

      sheet.getRangeByName('J${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('K${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('L${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('M${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('N${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('O${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('P${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('Q${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('R${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('S${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('T${index + 7}').cellStyle = numberColor;

      sheet.getRangeByName('U${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('V${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('W${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('X${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('Y${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('Z${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AA${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AB${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AC${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AD${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AE${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AF${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AG${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AH${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AI${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AJ${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AK${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AL${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AM${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AN${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AO${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AP${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AQ${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AR${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AS${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AT${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AU${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AV${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AW${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AX${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AY${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('AZ${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('BA${index + 7}').cellStyle = numberColor;
      sheet.getRangeByName('BB${index + 7}').cellStyle = numberColor;

////////----------------------->

////////----------------------->
      sheet.getRangeByName('A${index + 7}').setText('${index + 1}');
      sheet
          .getRangeByName('B${index + 7}')
          .setText('${teNantModels_Cancel[index].cid}'); //เลขที่สัญญา
      sheet
          .getRangeByName('C${index + 7}') //เลขที่สัญญาเดิม
          .setText('${teNantModels_Cancel[index].renew_cid}');

      //   sheet.getRangeByName('D${index + 7}').setText('');
      sheet.getRangeByName('D${index + 7}').setText(
            (teNantModels_Cancel[index].zn != null)
                ? (teNantModels_Cancel[index].zn!.split('_')[0].length <= 4)
                    ? 'CMN0${teNantModels_Cancel[index].zn!.split('_')[0]}'
                    : 'CMN${teNantModels_Cancel[index].zn!.split('_')[0]}'
                : (teNantModels_Cancel[index].zn1!.split('_')[0].length <= 4)
                    ? 'CMN0${teNantModels_Cancel[index].zn1!.split('_')[0]}'
                    : 'CMN${teNantModels_Cancel[index].zn1!.split('_')[0]}',
            // (teNantModels_Cancel[index].zser != null)
            //     ? '${teNantModels_Cancel[index].zser}'
            //     : '${teNantModels_Cancel[index].zser1}'
          ); // ที่ตัดออกเปลี่ยนเป็น col E แทน

      sheet.getRangeByName('E${index + 7}').setText(
            (teNantModels_Cancel[index].zn != null)
                ? '${teNantModels_Cancel[index].zn}'
                : '${teNantModels_Cancel[index].zn1}',
          ); //รหัสสาขา

      sheet
          .getRangeByName('F${index + 7}')
          .setText('${teNantModels_Cancel[index].ln}');

      sheet
          .getRangeByName('G${index + 7}')
          .setText('${teNantModels_Cancel[index].cname}');

      sheet
          .getRangeByName('H${index + 7}')
          .setText('${teNantModels_Cancel[index].addr}');

      sheet
          .getRangeByName('I${index + 7}')
          .setText('${teNantModels_Cancel[index].tel}');

      try {
        sheet.getRangeByName('J${index + 7}').cellStyle.numberFormat =
            'dd-MM-yyyy';
        sheet.getRangeByName('J${index + 7}').setValue(
              (teNantModels_Cancel[index].sdate == null ||
                      teNantModels_Cancel[index].sdate.toString() == '')
                  ? null
                  : DateTime.parse('${teNantModels_Cancel[index].sdate}'),
            );
      } catch (e) {
        sheet.getRangeByName('J${index + 7}').setText(
              (teNantModels_Cancel[index].sdate == null ||
                      teNantModels_Cancel[index].sdate.toString() == '')
                  ? ''
                  : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].sdate}'))}',
              // '${teNantModels_Cancel[index].sdate}'
            );
      }

      try {
        sheet.getRangeByName('K${index + 7}').cellStyle.numberFormat =
            'dd-MM-yyyy';
        sheet.getRangeByName('K${index + 7}').setValue(
              (teNantModels_Cancel[index].ldate == null ||
                      teNantModels_Cancel[index].ldate.toString() == '')
                  ? null
                  : DateTime.parse('${teNantModels_Cancel[index].ldate}'),
            );
      } catch (e) {
        sheet.getRangeByName('K${index + 7}').setText(
              (teNantModels_Cancel[index].ldate == null ||
                      teNantModels_Cancel[index].ldate.toString() == '')
                  ? ''
                  : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].ldate}'))}',
              // '${teNantModels_Cancel[index].ldate}'
            );
      }

      sheet
          .getRangeByName('L${index + 7}')
          .setText('${teNantModels_Cancel[index].stype}'); ////

      sheet.getRangeByName('M${index + 7}').setText(
          '${(teNantModels_Cancel[index].water_electri == null) ? '' : teNantModels_Cancel[index].water_electri.toString()}');

      try {
        sheet.getRangeByName('N${index + 7}').cellStyle.numberFormat =
            'dd-MM-yyyy';
        sheet.getRangeByName('N${index + 7}').setValue(
              (teNantModels_Cancel[index].cc_date == null ||
                      teNantModels_Cancel[index].cc_date.toString() == '')
                  ? null
                  : DateTime.parse('${teNantModels_Cancel[index].cc_date}'),
            );
      } catch (e) {
        sheet.getRangeByName('N${index + 7}').setText(
              (teNantModels_Cancel[index].cc_date == null ||
                      teNantModels_Cancel[index].cc_date.toString() == '')
                  ? ''
                  : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].cc_date}'))}',
              // '${teNantModels_Cancel[index].cc_date}'
            );
      }
      if (teNantModels_Cancel[index].st.toString() == 'สัญญาปัจจุบัน') {
        sheet.getRangeByName('O${index + 7}').setText('');
      } else {
        try {
          sheet.getRangeByName('O${index + 7}').cellStyle.numberFormat =
              'dd-MM-yyyy';
          sheet.getRangeByName('O${index + 7}').setValue(
                (teNantModels_Cancel[index].cdate == null ||
                        teNantModels_Cancel[index].cdate.toString() == '')
                    ? null
                    : DateTime.parse('${teNantModels_Cancel[index].cdate}'),
              );
        } catch (e) {
          sheet.getRangeByName('O${index + 7}').setText(
                (teNantModels_Cancel[index].cdate == null ||
                        teNantModels_Cancel[index].cdate.toString() == '')
                    ? ''
                    : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].cdate}'))}',
                // '${teNantModels_Cancel[index].cc_date}'
              );
        }
      }

      if (teNantModels_Cancel[index].st.toString() == 'สัญญาปัจจุบัน' ||
          teNantModels_Cancel[index].w1.toString() == '0000-00-00') {
        sheet.getRangeByName('P${index + 7}').setText('');
      } else {
        if (teNantModels_Cancel[index].w1.toString() == '0000-00-00') {
          sheet.getRangeByName('P${index + 7}').setText('');
        } else {
          try {
            sheet.getRangeByName('P${index + 7}').cellStyle.numberFormat =
                'dd-MM-yyyy';
            sheet.getRangeByName('P${index + 7}').setValue(
                  (teNantModels_Cancel[index].w1 == null ||
                          teNantModels_Cancel[index].w1.toString() == '')
                      ? null
                      : DateTime.parse('${teNantModels_Cancel[index].w1}'),
                );
          } catch (e) {
            sheet.getRangeByName('P${index + 7}').setText(
                  (teNantModels_Cancel[index].w1 == null ||
                          teNantModels_Cancel[index].w1.toString() == '')
                      ? ''
                      : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].w1}'))}',
                  // '${teNantModels_Cancel[index].cc_date}'
                );
          }
        }
      }

      sheet.getRangeByName('Q${index + 7}').setNumber(
            (teNantModels_Cancel[index].pakan_total == null)
                ? 0.00
                : double.parse('${teNantModels_Cancel[index].pakan_total}'),
          );

      sheet.getRangeByName('R${index + 7}').setNumber(
            (teNantModels_Cancel[index].pakan_total == null)
                ? 0.00
                : double.parse('${teNantModels_Cancel[index].pakan_total}'),
          );
      sheet.getRangeByName('S${index + 7}').setNumber(
            (teNantModels_Cancel[index].pakan_total == null)
                ? 0.00
                : double.parse('${teNantModels_Cancel[index].pakan_total}'),
          );
      try {
        sheet.getRangeByName('T${index + 7}').cellStyle.numberFormat =
            'dd-MM-yyyy';
        sheet.getRangeByName('TQ${index + 7}').setValue(
              (teNantModels_Cancel[index].min_pdate == null ||
                      teNantModels_Cancel[index].min_pdate.toString() == '')
                  ? null
                  : DateTime.parse('${teNantModels_Cancel[index].min_pdate}'),
            );
      } catch (e) {
        sheet.getRangeByName('T${index + 7}').setText(
              (teNantModels_Cancel[index].min_pdate == null ||
                      teNantModels_Cancel[index].min_pdate.toString() == '')
                  ? ''
                  : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].min_pdate}'))}',
              // (teNantModels_Cancel[index].min_pdate == null)
              //     ? ''
              //     : '${teNantModels_Cancel[index].min_pdate}'
            );
      }

      try {
        sheet.getRangeByName('T${index + 7}').cellStyle.numberFormat =
            'dd-MM-yyyy';
        sheet.getRangeByName('TS${index + 7}').setValue(
              (teNantModels_Cancel[index].min_pdate == null ||
                      teNantModels_Cancel[index].min_pdate.toString() == '')
                  ? null
                  : DateTime.parse('${teNantModels_Cancel[index].min_pdate}'),
            );
      } catch (e) {
        sheet.getRangeByName('T${index + 7}').setText(
              (teNantModels_Cancel[index].min_pdate == null ||
                      teNantModels_Cancel[index].min_pdate.toString() == '')
                  ? ''
                  : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].min_pdate}'))}',
              // (teNantModels_Cancel[index].min_pdate == null)
              //     ? ''
              //     : '${teNantModels_Cancel[index].min_pdate}'
            );
      }

      sheet.getRangeByName('T${index + 7}').setText(
          (teNantModels_Cancel[index].min_doctax == null &&
                  teNantModels_Cancel[index].min_docno == null)
              ? ''
              : (teNantModels_Cancel[index].min_doctax == null ||
                      teNantModels_Cancel[index].min_doctax.toString() == '')
                  ? '${teNantModels_Cancel[index].min_docno}'
                  : '${teNantModels_Cancel[index].min_doctax}');

      sheet.getRangeByName('U${index + 7}').setText(
          (teNantModels_Cancel[index].min_doctax == null &&
                  teNantModels_Cancel[index].min_docno == null)
              ? ''
              : (teNantModels_Cancel[index].min_doctax == null ||
                      teNantModels_Cancel[index].min_doctax.toString() == '')
                  ? '${teNantModels_Cancel[index].min_docno}'
                  : '${teNantModels_Cancel[index].min_doctax}');

      sheet.getRangeByName('V${index + 7}').setNumber(
          (teNantModels_Cancel[index].pakan_pvat == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].pakan_pvat}'));

      sheet.getRangeByName('W${index + 7}').setNumber(
          (teNantModels_Cancel[index].land_pvat == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].land_pvat}'));

      sheet.getRangeByName('X${index + 7}').setNumber(
          (teNantModels_Cancel[index].rent_pvat == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].rent_pvat}'));

      ///---

      sheet.getRangeByName('Y${index + 7}').setNumber(
          (teNantModels_Cancel[index].service_pvat == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].service_pvat}'));

      sheet.getRangeByName('Z${index + 7}').setNumber(
          (teNantModels_Cancel[index].water == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].water}'));
      sheet.getRangeByName('AA${index + 7}').setNumber(
          (teNantModels_Cancel[index].electricity == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].electricity}'));

      sheet.getRangeByName('AB${index + 7}').setNumber(
          (teNantModels_Cancel[index].fine == null)
              ? 0.00
              : double.parse('${teNantModels_Cancel[index].fine}'));
      sheet
          .getRangeByName('AC${index + 7}')
          .setFormula('=SUM(V${index + 7}:AA${index + 7})'
              // '=SUM(U${index + 7})-SUM(V${index + 7}:AA${index + 7})'

              );
      // sheet
      //     .getRangeByName('AB${index + 7}')
      //     .setFormula('=SUM(U${index + 7}:Z${index + 7})');

      // sheet.getRangeByName('W${index + 7}').setNumber(
      //     (teNantModels_Cancel[index].total_bill == null)
      //         ? 0.00
      //         : double.parse('${teNantModels_Cancel[index].total_bill}'));

      sheet.getRangeByName('AC${index + 7}').setNumber(0.00
          // (teNantModels_Cancel[index].total_pay == null)
          //     ? 0.00
          //     : double.parse('${teNantModels_Cancel[index].total_pay}')
          );
      sheet.getRangeByName('AD${index + 7}').setNumber(0.00);
      // try {
      //   sheet.getRangeByName('AC${index + 7}').cellStyle.numberFormat =
      //       'dd-MM-yyyy';
      //   sheet.getRangeByName('AC${index + 7}').setValue(
      //         (teNantModels_Cancel[index].pdate == null ||
      //                 teNantModels_Cancel[index].pdate.toString() == '')
      //             ? null
      //             : DateTime.parse('${teNantModels_Cancel[index].pdate}'),
      //       );
      // } catch (e) {
      //   sheet.getRangeByName('AC${index + 7}').setText(
      //         (teNantModels_Cancel[index].pdate == null ||
      //                 teNantModels_Cancel[index].pdate.toString() == '')
      //             ? ''
      //             : '${DateFormat('dd-MM-yyyy').format(DateTime.parse('${teNantModels_Cancel[index].pdate}'))}',
      //         // (teNantModels_Cancel[index].pdate == null)
      //         //     ? ''
      //         //     : '${teNantModels_Cancel[index].pdate}'
      //       );
      // }

      sheet.getRangeByName('AE${index + 7}').setNumber(0.00
          // (teNantModels_Cancel[index].total_bill == null)
          //     ? 0.00
          //     : double.parse('${teNantModels_Cancel[index].total_bill}')
          );

      sheet.getRangeByName('AF${index + 7}').setNumber(0.00
          // (teNantModels_Cancel[index].total_bill == null)
          //     ? 0.00 - double.parse('${teNantModels_Cancel[index].pakan_pvat}')
          //     : double.parse('${teNantModels_Cancel[index].total_bill}') -
          //         double.parse('${teNantModels_Cancel[index].pakan_pvat}')
          );

      sheet.getRangeByName('AG${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AH${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AI${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AJ${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AK${index + 7}').setNumber(0.00);

      // เพิ่ม
      sheet.getRangeByName('AL${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AM${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AN${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AO${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AP${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AQ${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AR${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AS${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AT${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AU${index + 7}').setText('');
      sheet.getRangeByName('AV${index + 7}').setNumber(0.00);
      sheet.getRangeByName('AW${index + 7}').setNumber(0.00);

      sheet
          .getRangeByName('AX${index + 7}')
          .setText('${teNantModels_Cancel[index].name_user}');

      sheet
          .getRangeByName('AY${index + 7}')
          .setText('${teNantModels_Cancel[index].cc_remark}');

      sheet.getRangeByName('AZ${index + 7}').setText(
          (teNantModels_Cancel[index].inv == null)
              ? ''
              : '${teNantModels_Cancel[index].inv}');

      sheet.getRangeByName('BA${index + 7}').setText(
          (teNantModels_Cancel[index].wnote == null)
              ? ''
              : '${teNantModels_Cancel[index].wnote}');
      sheet
          .getRangeByName('BB${index + 7}')
          .setText((teNantModels_Cancel[index].st == null)
              ? ''
              : (teNantModels_Cancel[index].st.toString() == 'สัญญาปัจจุบัน')
                  ? 'รอดำเนินการยกเลิกสัญญา'
                  : '${teNantModels_Cancel[index].st}');

      indextotol = indextotol + 1;
    }

/////////---------------------------->
    sheet.getRangeByName('Q${indextotol + 7 + 0}').setText('รวมทั้งหมด: ');
    sheet
        .getRangeByName('R${indextotol + 7 + 0}')
        .setFormula('=SUM(R3:R${indextotol + 7 - 1})');
    sheet
        .getRangeByName('U${indextotol + 7 + 0}')
        .setFormula('=SUM(U3:U${indextotol + 7 - 1})');
    sheet
        .getRangeByName('V${indextotol + 7 + 0}')
        .setFormula('=SUM(V3:V${indextotol + 7 - 1})');
    sheet
        .getRangeByName('W${indextotol + 7 + 0}')
        .setFormula('=SUM(W3:W${indextotol + 7 - 1})');
    sheet
        .getRangeByName('X${indextotol + 7 + 0}')
        .setFormula('=SUM(X3:X${indextotol + 7 - 1})');
    sheet
        .getRangeByName('Y${indextotol + 7 + 0}')
        .setFormula('=SUM(Y3:Y${indextotol + 7 - 1})');
    sheet
        .getRangeByName('Z${indextotol + 7 + 0}')
        .setFormula('=SUM(Z3:Z${indextotol + 7 - 1})');
    sheet
        .getRangeByName('AA${indextotol + 7 + 0}')
        .setFormula('=SUM(AA3:AA${indextotol + 7 - 1})');
    sheet
        .getRangeByName('AB${indextotol + 7 + 0}')
        .setFormula('=SUM(AB3:AB${indextotol + 7 - 1})');
    sheet
        .getRangeByName('AC${indextotol + 7 + 0}')
        .setFormula('=SUM(AC3:AC${indextotol + 7 - 1})');
    sheet
        .getRangeByName('AE${indextotol + 7 + 0}')
        .setFormula('=SUM(AE3:AE${indextotol + 7 - 1})');
    sheet
        .getRangeByName('AF${indextotol + 7 + 0}')
        .setFormula('=SUM(AF3:AF${indextotol + 7 - 1})');

    sheet.getRangeByName('Q${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('R${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('S${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('T${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('U${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('V${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('W${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('X${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('Y${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('Z${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AA${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AB${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AC${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AD${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AE${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AF${indextotol + 7 + 0}').cellStyle = globalStyle7;

    //เพิ่ม
    sheet.getRangeByName('AG${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AH${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AI${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AJ${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AK${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AL${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AM${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AN${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AO${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AP${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AQ${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AR${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AS${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AT${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AU${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AV${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AW${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AX${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AY${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('AZ${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('BA${indextotol + 7 + 0}').cellStyle = globalStyle7;
    sheet.getRangeByName('BB${indextotol + 7 + 0}').cellStyle = globalStyle7;
